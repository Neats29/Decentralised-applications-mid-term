<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">
  <!-- <link rel="stylesheet" href="https://gateway.ipfs.io/ipfs/QmeNhQMWkeDmANgj6AWfdqtdQrkvFFr88Ukoefu6Nc2XZL"> -->
  <!-- <script defer src="https://use.fontawesome.com/releases/v5.0.7/js/all.js"></script> -->
</head>

<body>
  <h1 class="is-size-3 has-text-centered">Codenames</h1>
  <div class="container">
    <div class="columns is-mobile">
      <div class="column is-one-third">
        <button class="button is-large btn" id="0"></button>
      </div>
      <div class="column is-one-third">
        <button class="button is-large btn" id="1"></button>
      </div>
      <div class="column is-one-third">
        <button class="button is-large btn" id="2"></button>
      </div>
    </div>
    <div class="columns is-mobile">
      <div class="column is-one-third">
        <button class="button is-large btn" id="3"></button>
      </div>
      <div class="column is-one-third">
        <button class="button is-large btn" id="4"></button>
      </div>
      <div class="column is-one-third">
        <button class="button is-large btn" id="5"></button>
      </div>
    </div>
    <div class="columns is-mobile">
      <div class="column is-one-third">
        <button class="button is-large btn" id="6"></button>
      </div>
      <div class="column is-one-third">
        <button class="button is-large btn" id="7"></button>
      </div>
      <div class="column is-one-third">
        <button class="button is-large btn" id="8"></button>
      </div>
    </div>
  </div>
  <div class="column is-3 is-offset-one-third">
    <div class="field">
      <div class="control">
        <input type="text" class="input is-medium" placeholder="Send your clue">
      </div>
    </div>
  </div>
  </div>
  </div>
  <script>

    // on page load
    document.addEventListener("DOMContentLoaded", function () {
      fetch('/init-board').then(function (res) {
        return res.json()
      }).then(function (data) {
        let index = 0
        data.boardState.forEach(function (a, i) {
          document.getElementById(i).innerHTML = data.randomWords[index]
          index++
        })
        play(data.boardState)
      }).catch(console.log)
    });


    function play(boardState) {
      let arr = []
      let numSqaures = 9
      for (var a = 0; a < numSqaures; a++) {
        arr.push(document.getElementById(a))
        arr[a].addEventListener("click", function () {
          flip(boardState)
        })
      }
    }

    // Reveals what type of card it was by looking up the corresponding index in boardState
    function flip(boardState) {
      if (boardState[getElementID(event)] == "S") {
        document.getElementById(getElementID(event)).style.backgroundColor = "red"
        document.getElementById(getElementID(event)).innerHTML = "Secret Agent";
      }
      else if (boardState[getElementID(event)] == "B") {
        document.getElementById(getElementID(event)).style.backgroundColor = "white"
        document.getElementById(getElementID(event)).innerHTML = "Bystander";
      }
      else {
        document.getElementById(getElementID(event)).style.backgroundColor = "black"
        document.getElementById(getElementID(event)).innerHTML = "Assassin";
      }
    }

    var getElementID = function (event) {
      return event.path[0].id
    }

  </script>

</body>

</html>